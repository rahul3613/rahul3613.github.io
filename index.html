<!DOCTYPE html>
<html lang="en">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta charset="UTF-8">
    <title>NISER | Canteen Menu</title>
    <meta name="description" content="NISR | Canteen Menu">
    <meta name="author" content="Abhishek Anil Deshmukh">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <!-- link(rel="stylesheet", href="./css/style.css") // Old cached-->
    <style> /*! normalize.css v8.0.1 | MIT License | github.com/necolas/normalize.css */
/* Document
   ========================================================================== */
/**
 * 1. Correct the line height in all browsers.
 * 2. Prevent adjustments of font size after orientation changes in iOS.
 */
html {
  line-height: 1.15;
  /* 1 */
  -webkit-text-size-adjust: 100%;
  /* 2 */
}

/* Sections
   ========================================================================== */
/**
 * Remove the margin in all browsers.
 */
body {
  margin: 0;
}

/**
 * Render the `main` element consistently in IE.
 */
main {
  display: block;
}

/**
 * Correct the font size and margin on `h1` elements within `section` and
 * `article` contexts in Chrome, Firefox, and Safari.
 */
h1 {
  font-size: 2em;
  margin: 0.67em 0;
}

/* Grouping content
   ========================================================================== */
/**
 * 1. Add the correct box sizing in Firefox.
 * 2. Show the overflow in Edge and IE.
 */
hr {
  -webkit-box-sizing: content-box;
  box-sizing: content-box;
  /* 1 */
  height: 0;
  /* 1 */
  overflow: visible;
  /* 2 */
}

/**
 * 1. Correct the inheritance and scaling of font size in all browsers.
 * 2. Correct the odd `em` font sizing in all browsers.
 */
pre {
  font-family: monospace, monospace;
  /* 1 */
  font-size: 1em;
  /* 2 */
}

/* Text-level semantics
   ========================================================================== */
/**
 * Remove the gray background on active links in IE 10.
 */
a {
  background-color: transparent;
}

/**
 * 1. Remove the bottom border in Chrome 57-
 * 2. Add the correct text decoration in Chrome, Edge, IE, Opera, and Safari.
 */
abbr[title] {
  border-bottom: none;
  /* 1 */
  text-decoration: underline;
  /* 2 */
  -webkit-text-decoration: underline dotted;
  text-decoration: underline dotted;
  /* 2 */
}

/**
 * Add the correct font weight in Chrome, Edge, and Safari.
 */
b,
strong {
  font-weight: bolder;
}

/**
 * 1. Correct the inheritance and scaling of font size in all browsers.
 * 2. Correct the odd `em` font sizing in all browsers.
 */
code,
kbd,
samp {
  font-family: monospace, monospace;
  /* 1 */
  font-size: 1em;
  /* 2 */
}

/**
 * Add the correct font size in all browsers.
 */
small {
  font-size: 80%;
}

/**
 * Prevent `sub` and `sup` elements from affecting the line height in
 * all browsers.
 */
sub,
sup {
  font-size: 75%;
  line-height: 0;
  position: relative;
  vertical-align: baseline;
}

sub {
  bottom: -0.25em;
}

sup {
  top: -0.5em;
}

/* Embedded content
   ========================================================================== */
/**
 * Remove the border on images inside links in IE 10.
 */
img {
  border-style: none;
}

/* Forms
   ========================================================================== */
/**
 * 1. Change the font styles in all browsers.
 * 2. Remove the margin in Firefox and Safari.
 */
button,
input,
optgroup,
select,
textarea {
  font-family: inherit;
  /* 1 */
  font-size: 100%;
  /* 1 */
  line-height: 1.15;
  /* 1 */
  margin: 0;
  /* 2 */
}

/**
 * Show the overflow in IE.
 * 1. Show the overflow in Edge.
 */
button,
input {
  /* 1 */
  overflow: visible;
}

/**
 * Remove the inheritance of text transform in Edge, Firefox, and IE.
 * 1. Remove the inheritance of text transform in Firefox.
 */
button,
select {
  /* 1 */
  text-transform: none;
}

/**
 * Correct the inability to style clickable types in iOS and Safari.
 */
button,
[type="button"],
[type="reset"],
[type="submit"] {
  -webkit-appearance: button;
}

/**
 * Remove the inner border and padding in Firefox.
 */
button::-moz-focus-inner,
[type="button"]::-moz-focus-inner,
[type="reset"]::-moz-focus-inner,
[type="submit"]::-moz-focus-inner {
  border-style: none;
  padding: 0;
}

/**
 * Restore the focus styles unset by the previous rule.
 */
button:-moz-focusring,
[type="button"]:-moz-focusring,
[type="reset"]:-moz-focusring,
[type="submit"]:-moz-focusring {
  outline: 1px dotted ButtonText;
}

/**
 * Correct the padding in Firefox.
 */
fieldset {
  padding: 0.35em 0.75em 0.625em;
}

/**
 * 1. Correct the text wrapping in Edge and IE.
 * 2. Correct the color inheritance from `fieldset` elements in IE.
 * 3. Remove the padding so developers are not caught out when they zero out
 *    `fieldset` elements in all browsers.
 */
legend {
  -webkit-box-sizing: border-box;
  box-sizing: border-box;
  /* 1 */
  color: inherit;
  /* 2 */
  display: table;
  /* 1 */
  max-width: 100%;
  /* 1 */
  padding: 0;
  /* 3 */
  white-space: normal;
  /* 1 */
}

/**
 * Add the correct vertical alignment in Chrome, Firefox, and Opera.
 */
progress {
  vertical-align: baseline;
}

/**
 * Remove the default vertical scrollbar in IE 10+.
 */
textarea {
  overflow: auto;
}

/**
 * 1. Add the correct box sizing in IE 10.
 * 2. Remove the padding in IE 10.
 */
[type="checkbox"],
[type="radio"] {
  -webkit-box-sizing: border-box;
  box-sizing: border-box;
  /* 1 */
  padding: 0;
  /* 2 */
}

/**
 * Correct the cursor style of increment and decrement buttons in Chrome.
 */
[type="number"]::-webkit-inner-spin-button,
[type="number"]::-webkit-outer-spin-button {
  height: auto;
}

/**
 * 1. Correct the odd appearance in Chrome and Safari.
 * 2. Correct the outline style in Safari.
 */
[type="search"] {
  -webkit-appearance: textfield;
  /* 1 */
  outline-offset: -2px;
  /* 2 */
}

/**
 * Remove the inner padding in Chrome and Safari on macOS.
 */
[type="search"]::-webkit-search-decoration {
  -webkit-appearance: none;
}

/**
 * 1. Correct the inability to style clickable types in iOS and Safari.
 * 2. Change font properties to `inherit` in Safari.
 */
::-webkit-file-upload-button {
  -webkit-appearance: button;
  /* 1 */
  font: inherit;
  /* 2 */
}

/* Interactive
   ========================================================================== */
/*
 * Add the correct display in Edge, IE 10+, and Firefox.
 */
details {
  display: block;
}

/*
 * Add the correct display in all browsers.
 */
summary {
  display: list-item;
}

/* Misc
   ========================================================================== */
/**
 * Add the correct display in IE 10+.
 */
template {
  display: none;
}

/**
 * Add the correct display in IE 10.
 */
[hidden] {
  display: none;
}

@font-face {
  font-family: 'Fira Sans';
  font-style: normal;
  font-weight: 400;
  src: url(../static/FiraSans-Regular.otf);
}

html {
  --main-background-color: linear-gradient(147deg, #282a36 0%, #383a59 74%);
  --card-background: #282a36;
  --canteen-color: #bd93f9;
  --dark-text-color: #ff79c6;
  --timestamp-color: #6272a4;
  --menu-color: #f8f8f2;
  --footer-color: #ff79c6;
}

body {
  background-image: var(--main-background-color);
  min-height: 100vh;
  text-align: center;
  color: var(--dark-text-color);
  font-family: 'Fira Sans';
}

/* the heading */
header {
  font-size: 25px;
  padding-top: 10px;
}

.meal {
  display: block;
  height: 20px;
  background-color: transparent;
  color: var(--dark-text-color);
  font-weight: 400;
  font-size: 19px;
  letter-spacing: 0.036em;
  line-height: 1.7;
}

#theme-toggle {
  background: transparent;
  border: none;
}

/* the swipe view thingy*/
.swipe-view {
  display: grid;
  grid-template-columns: repeat(4, 100%);
  will-change: transform;
  -ms-flex-line-pack: center;
  align-content: center;
  overflow-x: auto;
  -ms-scroll-snap-coordinate: 0 0;
  scroll-snap-coordinate: 0 0;
  -ms-scroll-snap-points-x: repeat(100%);
  scroll-snap-points-x: repeat(100%);
  -ms-scroll-snap-type: x mandatory;
  scroll-snap-type: x mandatory;
  -webkit-overflow-scrolling: touch;
}

section {
  width: 100vw;
  height: 100%;
  -webkit-box-flex: 0;
  -ms-flex: 0 0 100vw;
  flex: 0 0 100vw;
  scroll-snap-align: start;
}

/* the card */
.canteen-card {
  display: inline-block;
  width: 80vw;
  background: var(--card-background);
  margin: 15px 0px 15px 0px;
  padding: 20px 10px 10px 18px;
  text-align: left;
  min-height: 150px;
  border-radius: 20px;
}

.icon {
  height: 15px;
  margin-right: 5px;
}

.canteen-name {
  color: var(--canteen-color);
  font-size: 28px;
  line-height: 1.3;
  letter-spacing: 0.097em;
  font-weight: 700;
  font-style: normal;
}

.timestamp {
  color: var(--timestamp-color);
  font-size: 15px;
  font-style: normal;
  line-height: 1;
  letter-spacing: 0.026em;
  font-weight: 500;
}

.menu {
  color: var(--menu-color);
  line-height: 1.3;
  letter-spacing: 0.032em;
  font-size: 20px;
  font-weight: 500;
  font-style: normal;
}

.hide {
  display: none;
}

/* footer */
footer {
  color: var(--footer-color);
  margin-bottom: 10px;
}

footer a {
  color: var(--footer-color);
}</style>
    <!-- script(src="./js/main.js") // Old cached-->
    <script>
var csvLink = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vSpgPFjsVbVak8MuXxOYEV8ezmsXC38Ki13xHcGwVt3YbFRoRSKwiRemMk9lCGOKRsDCrlYtD2ePg7V/pub?output=csv';
var request;
if (window.XMLHttpRequest) {
    request = new XMLHttpRequest();
}
else {
    request = new ActiveXObject("Microsoft.XMLHTTP");
}
var loading = true;
request.open('GET', csvLink, true);
request.send();
request.onload = function (e) {
    if (request.readyState === 4) {
        if (request.status === 200) {
            var response = request.responseText;
            var lines = request.responseText.split("\r");
            for (var _i = 0, _a = lines.slice(1); _i < _a.length; _i++) {
                var line = _a[_i];
                var line_json = CSVtoArray(line);
                var time = line_json[0].split(" ");
                time = make_date_friendly(time[0]) + " " + time[1];
                var canteen = line_json[1];
                var breakfast = line_json[2];
                var lunch = line_json[3];
                var snacks = line_json[4];
                var dinner = line_json[5];
                addCanteen(time, canteen, [breakfast, lunch, snacks, dinner]);
            }
            // moving to the relevant meal
            move();
            // set to reload after a certain amount of time
            setToReload();
        }
        else {
            console.error(request.statusText);
        }
    }
};
function CSVtoArray(text) {
    var re_valid = /^\s*(?:'[^'\\]*(?:\\[\S\s][^'\\]*)*'|"[^"\\]*(?:\\[\S\s][^"\\]*)*"|[^,'"\s\\]*(?:\s+[^,'"\s\\]+)*)\s*(?:,\s*(?:'[^'\\]*(?:\\[\S\s][^'\\]*)*'|"[^"\\]*(?:\\[\S\s][^"\\]*)*"|[^,'"\s\\]*(?:\s+[^,'"\s\\]+)*)\s*)*$/;
    var re_value = /(?!\s*$)\s*(?:'([^'\\]*(?:\\[\S\s][^'\\]*)*)'|"([^"\\]*(?:\\[\S\s][^"\\]*)*)"|([^,'"\s\\]*(?:\s+[^,'"\s\\]+)*))\s*(?:,|$)/g;
    // Return NULL if input string is not well formed CSV string.
    if (!re_valid.test(text))
        return null;
    var a = []; // Initialize array to receive values.
    text.replace(re_value, function (m0, m1, m2, m3) {
        // Remove backslash from \' in single quoted values.
        if (m1 !== undefined)
            a.push(m1.replace(/\\'/g, "'"));
        // Remove backslash from \" in double quoted values.
        else if (m2 !== undefined)
            a.push(m2.replace(/\\"/g, '"'));
        else if (m3 !== undefined)
            a.push(m3);
        return ''; // Return empty string.
    });
    // Handle special case of empty last value.
    if (/,\s*$/.test(text))
        a.push('');
    return a;
}
;
function make_date_friendly(date) {
    var now = new Date();
    var today = (now.getMonth() + 1).toString() +
        '/' +
        now.getDate().toString() +
        '/' +
        now.getFullYear().toString();
    now.setDate(now.getDate() - 1); // going a day back
    var yesterday = (now.getMonth() + 1).toString() +
        '/' +
        now.getDate().toString() +
        '/' +
        now.getFullYear().toString();
    if (date == today) {
        return 'Today';
    }
    else if (date == yesterday) {
        return 'Yesterday';
    }
    return date;
}
function addCanteen(time, canteen, meals) {
    if (loading) {
        document.querySelector("#skeleton").classList.add("hide");
        loading = false;
    }
    var sections = document.getElementsByTagName('section');
    for (var section in sections) {
        if (typeof sections[section] == 'object') {
            sections[section].innerHTML +=
                '<div class=canteen-card><span class=canteen-name>' +
                    canteen +
                    '</span><br /><span class=timestamp>' +
                    time +
                    '</span><br /><br/><span class=menu>' +
                    meals[section] +
                    '</span></div>';
        }
    }
}
//moving to section according to time
function move() {
    var hours = new Date().getHours();
    var section_no = 0;
    var sections = document.getElementsByTagName('section');
    if (hours >= 22 || hours < 10) {
        // breakfast case
    }
    else if (hours >= 10 && hours < 14) {
        // lunch case
        section_no = 1;
    }
    else if (hours >= 14 && hours < 18) {
        // snacks case
        section_no = 2;
    }
    else {
        // dinner case
        section_no = 3;
    }
    var location = '-' + section_no.toString() + '00vw';
    sections[0].style['margin-left'] = location;
    sections[1].style['margin-left'] = location;
    sections[2].style['margin-left'] = location;
    sections[3].style['margin-left'] = location;
}
// function to reload on appropriate times
function setToReload() {
    var hours = new Date().getHours();
    var milliSecsToWait = 0;
    if (hours < 9) {
        milliSecsToWait = (9 - hours) * 60 * 60 * 1000;
    }
    else if (hours < 14) {
        milliSecsToWait = (14 - hours) * 60 * 60 * 1000;
    }
    else if (hours < 19) {
        milliSecsToWait = (19 - hours) * 60 * 60 * 1000;
    }
    else {
        milliSecsToWait = (24 - hours + 9) * 60 * 60 * 1000;
    }
    setTimeout(function () {
        history.go();
    }, milliSecsToWait);
}
</script>
  </head>
  <body>
    <header>NISER | Canteen Menu</header>
    <main class="swipe-view">
      <section id="breakfast">
        <div class="meal">Breakfast</div>
        <div class="canteen-card" id="skeleton"><span class="canteen-name"></span><br><span class="timestamp"></span><br><span class="menu"></span></div>
      </section>
      <section id="lunch">
        <div class="meal">Lunch</div>
      </section>
      <section id="snacks">
        <div class="meal">Snacks</div>
      </section>
      <section id="dinner">
        <div class="meal">Dinner</div>
      </section>
    </main>
    <footer>
      Source at
      <a href="http://github.com/smlab-niser/niser-canteen-menu" target="_blank">github</a><br>
      Made with â™¥ by
      <a href="https://deshmukh.ml" target="_blank">Abhishek Anil Deshmukh</a><br><a href="https://www.niser.ac.in/~smishra/index.html" target="_blank">Subhankar Mishra's LAB</a>
    </footer>
  </body>
</html>
